<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
		"http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>
		<title>doh.robot ApplicationWidget Test</title>

		<style>
			@import "../../../util/doh/robot/robot.css";
		</style>

		<!-- required: dojo.js -->
		<script type="text/javascript" src="../../../src/js/dojo/dojo-release-1.6.1-src/dojo/dojo.js"
			djConfig="isDebug: true"></script>


		<script type="text/javascript">
            dojo.registerModulePath('rishson', '../../../rishson');

			dojo.require('rishson.enterprise.widget._Widget');
			dojo.require('rishson.enterprise.widget._ApplicationWidget');

			dojo.require("dojo.window");
			dojo.require("dijit.robotx");

			dojo.ready(function(){
				doh.robot.initRobot('../../functional/testApplicationWidget.html');

				doh.register("_ApplicationWidget tests", [	
					{
						name: "Pub/sub tests",
						setUp: function(){
							dojo.declare('childWidget', [rishson.enterprise.widget._Widget], {
								constructor : function(params) {
									this.pubList.SOME_TOPIC = '/some/topicName';			
								}			
							});

							dojo.declare('parentWidget', [rishson.enterprise.widget._ApplicationWidget], {
								constructor : function(params) {
								},
	

								_handleSomeTopicName : function(data){
									horribleGlobalScopeHack = true;
									doh.assertTrue(data[0] === 'hello world');
								}			
							});

							var myChildWidget = new childWidget();
							var myApplicationWidget = new applicationWidget();
						},
						runTest: function(){
							myApplicationWidget.injectWidget(myChildWidget);

							dojo.publish(myChildWidget.pubList.SOME_TOPIC, ['hello world']);
			
							doh.assertTrue(horribleGlobalScopeHack, 'Autowire faied.');
						},
						tearDown: function(){
						}
					}

				]);
				doh.run();
			});
		</script>
	</head>
</html>
